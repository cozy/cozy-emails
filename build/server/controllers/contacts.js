// Generated by CoffeeScript 1.9.0
var Contact;

Contact = require('../models/contact');

module.exports.list = function(req, res, next) {
  return Contact.list(function(err, contacts) {
    if (err) {
      return next(err);
    }
    return res.send(contacts);
  });
};

module.exports.picture = function(req, res, next) {
  var filename, id, stream;
  id = req.params.contactID;
  filename = 'picture';
  stream = Contact.getFile(id, filename, function(err) {
    return next(err);
  });
  stream.pipefilter = function(dsResponse) {
    var header, value, _ref, _results;
    _ref = dsResponse.headers;
    _results = [];
    for (header in _ref) {
      value = _ref[header];
      _results.push(res.setHeader(header, value));
    }
    return _results;
  };
  req.on('close', function() {
    return stream.abort();
  });
  res.on('close', function() {
    return stream.abort();
  });
  return stream.pipe(res);
};
