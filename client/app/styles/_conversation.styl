/*
  Conversation

  -- List of collapsable message content
*/

.conversation
    padding 1.5em

    & > header
        display       flex
        align-items   flex-start
        margin-bottom 1em

        h3
            flex 1
            order 1

        nav
            order 2

        .fa-close
            order 3

        .btn-group
            float none

        .btn
            float            none
            border           none
            color            grey-03
            background-color transparent
            font-size        1rem
            text-shadow      none
            box-shadow       none
            transition       color 0.2s ease-out

        &:hover .btn
            color grey-06

            &:hover
                color basecolor

        // Mask the fullscreen toggle below 768px, because the conversation view
        // is always fullscreen for those resolutions.
        @media(max-width: (768/16)em)
            .fullscreen
                display none


    &.enable
        display block

    .conversation-title
        margin 0
        font 1.5em/1.2 'Source Sans Pro', sans-serif
        color grey-08

    .more
        display block
        padding .8em 0.2rem
        width 100%
        border none
        border-top 1px solid grey-03
        background-color #fff
        font-size .875em
        text-align left
        color basecolor
        line-height 1.63265em

        &:hover
            color darken(basecolor, 20%)

        &:active
            outline none

        i
            vertical-align middle
            padding-right 0.8em

    .message
        margin 0
        padding .8em 0.2rem
        border-top 1px solid grey-03
        border-bottom none
        background-color white

        &.active

            // prevent first message from sliding down for no reason
            &:first-of-type
                margin-top 0

            header
                margin-bottom 1em

                .show-contact
                .add-contact
                    visibility visible

            .sender-avatar
                width 40px
                height 40px

            .infos
                margin-bottom 1em
                padding-bottom .5em
                border-bottom 1px solid lightcolor

                .addresses
                    display block !important

        &.isUnread
            font-weight bold
            color basecolor

        // compose
        .compose
            margin-bottom  1em
            padding-bottom 2em
            border-bottom  1px solid grey-03

        header
        footer
            font-size .875em

        header
            cursor pointer

            .show-contact
            .add-contact
                color grey-03
                margin 0 5px
                visibility hidden

                button
                    background transparent
                    border 0

        &:hover header
            .show-contact
            .add-contact
                color grey-06
                transition color 0.2s ease-out

                &:hover
                    color basecolor

        footer
            margin-top 1em
            padding-top .5em
            border-top 1px solid lightcolor

        .full-headers textarea
            width 100%
            height 15em
            resize none
            display block
            margin-bottom 1em
            border 1px solid lightcolor
            border-radius 2px
            font-size .75em
            font-family "Source Code Pro", monospace
            background-color lighten(grey-01, 50%)

        iframe
            width 100%

        .toolbar-message .btn-group-sm>.btn
            font-size 1rem

        .sender-avatar
            float left
            margin 0 10px 0 0
            width 24px
            height 24px
            overflow hidden
            border-radius 2px

            img
                max-width 100%
                max-height 100%
                border-radius 200em

        .infos
            position relative
            display flex
            flex-flow row wrap
            align-items center

            .addresses
                flex 1 1 55%
                min-height 1.63265em
                line-height 1.63265em

                + .addresses
                    // Mask addresses (except from, 1st one) when message isnt
                    // active (so collpased)
                    display      none
                    // Set the "special wrapping trick" for flex-items
                    padding-left 100%
                    max-width    0
                    position     relative

                    .addresses-wrapper
                        position      absolute
                        left          0
                        width         100%
                        overflow      hidden
                        text-overflow ellipsis
                        white-space   nowrap

                .field
                    margin-right 0.5em

                a:hover
                    text-decoration none

                &.from .highlight
                    font-size   1.05em
                    font-weight bold

            .participant
                color darkcolor

            .contact-address
                color       mediumcolor
                white-space nowrap

                i
                    padding 0 .2em

            .indicators i
                margin-left .5em

            .from
                order 1
            .indicators
                order       2
                display     flex
                align-items center
            .date
                order 3
                color grey-05
            .to
                order 5
            .cc
                order 6
            .details
                order         4
                padding-right 10px
                color grey-05

            .metas
                margin-left 1em

        .fa-star
            color lightorange

        .infos [aria-expanded]
            position relative

            .btn
                padding 0
                color grey-05
                font-size 1rem

                &:hover
                    color basecolor

            .popup
                z-index 1
                position absolute
                top 100%
                right 0
                min-width 18em
                padding 0.5em 10px
                border 1px solid grey-03
                border-radius 5px
                background white
                box-shadow 0 1px 3px rgba(0,0,0,.12)

                td
                    display table-cell
                    padding 0.3em
                    color darkcolor
                    font-size 1em
                    vertical-align baseline

                .label
                    text-align right
                    font-weight normal
                    font-size 0.85em
                    color mediumcolor
                    text-transform uppercase

            [aria-hidden=true]
                display none

        .attachments .popup
                right .25em !important

        .alert-success
        .alert-info
        .alert-warning
        .alert-danger
            margin-bottom 1em
            padding .5em 10px
            border-radius 2px
            font-size .875em
            line-height 2em
            text-align center
            background lighten(grey-01,50%)
            color grey-07
            border 0

            i
                margin-right 0.5em

        .btn-success
        .btn-info
        .btn-warning
        .btn-danger
            display inline-block
            margin-left .75em
            vertical-align baseline
            text-shadow none
            box-shadow none
            background-color grey-04
            border 0px
            color white
            cursor pointer
            padding 5px
            outline 0

            &:hover
                background-color grey-06

        .attachments
            ul
                display flex
                flex-wrap wrap
                margin 0
                padding 0

            li
                display          flex
                align-items      center
                flex             none
                margin           0.25em 0.5em 0.25em 0
                padding          0.6em 0.8em
                background-color lighten(grey-01, 50%)
                border-radius    3px
                list-style-type  none
                white-space      nowrap

            i
                display inline-block
                margin-right 0.3em

            img
                display inline-block
                margin-right .5em
                padding .2em
                vertical-align middle
                background-color #ffffff
                border-radius 2px
                border 1px solid grey-02

            a
                color grey-08

                &:hover
                    color basecolor
                    text-decoration none

                    img
                        border-color basecolor

            .file-details span:last-child
                margin-left 0.25em
                color grey-05

                &:before
                    content "("
                    display inline-block

                &:after
                    content ")"
                    display inline-block

            .file-actions
                margin-left 0.5em
                padding-left 0.5em
                border-left 1px solid grey-04
                color grey-05

            // hide the img icon (the picture's preview is enough)
            .mime.fa-file-image-o
                display none

    .att-preview
    .att-preview img
        padding 0.5em
    .att-preview button
        margin .5em

    // LAYOUT SPECIFICS
    // -------------------------------------------------------------------------
    .layout-column .messages-list + &
        border-left 1px solid grey-03

    .layout-row .messages-list + &
        border-top 2px solid grey-03
